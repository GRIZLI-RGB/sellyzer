---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";

import BasePageLayout from "./BasePageLayout.astro";

type Props = CollectionEntry<"blog">["data"] & { readingTime?: number };

const { title, description, pubDate, heroImage, tags, category, readingTime } =
	Astro.props;
---

<BasePageLayout title={title} description={description}>
	<article>
		<!-- Hero Image -->
		{
			heroImage && (
				<div class="default-container mb-8">
					<div
						class="relative overflow-hidden rounded-2xl aspect-video md:aspect-[21/9]"
						itemprop="image"
						itemscope
						itemtype="https://schema.org/ImageObject"
					>
						<Image
							quality={100}
							width={1200}
							height={600}
							src={heroImage}
							alt={title}
							class="!mt-0 w-full h-full object-cover"
							itemprop="url"
						/>
						<meta itemprop="width" content="1200" />
						<meta itemprop="height" content="600" />
					</div>
				</div>
			)
		}

		<!-- Article Content -->
		<div class="default-container">
			<div class="max-w-3xl mx-auto">
				<!-- Header with Schema.org markup -->
				<header class="text-center mb-12">
					<div class="flex items-center justify-center">
						<div
							class="px-4 py-2 bg-gray-100 rounded-full inline-flex items-center justify-center gap-3 text-sm text-gray-500 mb-6 flex-wrap"
						>
							<div class="flex items-center gap-2">
								<svg
									class="w-4 h-4"
									fill="none"
									stroke="currentColor"
									viewBox="0 0 24 24"
								>
									<path
										stroke-linecap="round"
										stroke-linejoin="round"
										stroke-width="2"
										d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
									></path>
								</svg>
								<time datetime={pubDate.toISOString()}>
									{
										pubDate.toLocaleDateString("ru-RU", {
											year: "numeric",
											month: "long",
											day: "numeric",
										})
									}
								</time>
							</div>
							<!-- <span class="text-gray-400">|</span>
							<div class="flex items-center gap-2">
								<svg
									class="w-4 h-4"
									fill="none"
									stroke="currentColor"
									viewBox="0 0 24 24"
								>
									<path
										stroke-linecap="round"
										stroke-linejoin="round"
										stroke-width="2"
										d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
									></path>
									<path
										stroke-linecap="round"
										stroke-linejoin="round"
										stroke-width="2"
										d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
									></path>
								</svg>
								<span>1.2K просмотров</span>
							</div> -->
							<span class="text-gray-400">|</span>
							<div class="flex items-center gap-2">
								<svg
									class="w-4 h-4"
									fill="none"
									stroke="currentColor"
									viewBox="0 0 24 24"
								>
									<path
										stroke-linecap="round"
										stroke-linejoin="round"
										stroke-width="2"
										d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
									></path>
								</svg>
								<span>{readingTime} мин. на чтение</span>
							</div>
						</div>
					</div>

					<h1
						class="text-4xl md:text-5xl font-bold text-gray-900 mb-6"
						itemprop="headline"
					>
						{title}
					</h1>

					{
						description && (
							<p
								class="text-xl text-gray-600 leading-relaxed max-w-3xl mx-auto"
								itemprop="description"
							>
								{description}
							</p>
						)
					}
				</header>

				<!-- Article Body -->
				<div
					class="border-t border-gray-200 pt-8"
					itemprop="articleBody"
				>
					<slot />
				</div>

				<!-- Improved Article Footer -->
				<footer class="border-t border-gray-200 mt-12 pt-8">
					<div class="flex flex-col">
						{
							tags && (
								<div class="flex flex-wrap gap-2 justify-start items-center">
									<span class="text-sm">Теги:</span>

									{tags.map((tag) => (
										<span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-medium">
											{tag}
										</span>
									))}
								</div>
							)
						}
						<div
							class="flex items-center justify-start gap-2 text-sm"
						>
							<span>Автор:</span>
							<div class="flex items-center gap-2">
								<img
									src={`/blog/avatar.jpg`}
									class="!shadow-none w-6 rounded-[999px]"
								/>
								<span class="font-semibold">Sellyzer Team</span>
							</div>
						</div>
					</div>
				</footer>
			</div>
		</div>
	</article>

	<section class="default-container pb-16 md:pb-24 mt-16">
		<div
			class="bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-2xl px-8 md:px-12 py-12 md:py-16 text-center"
		>
			<div class="max-w-2xl mx-auto">
				<h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-4">
					Готовы применить знания на практике?
				</h2>

				<p class="text-gray-600 mb-8 leading-relaxed text-lg">
					{
						category === "guides"
							? "В этом гайде мы разобрали только основы! Изучите все руководства, чтобы стать настоящим экспертом в продажах на маркетплейсах."
							: "Это лишь один из многих успешных кейсов! Изучите другие примеры, чтобы найти стратегии для вашего бизнеса."
					}
				</p>

				<div
					class="flex flex-col sm:flex-row gap-4 justify-center items-stretch"
				>
					<!-- Основная кнопка - всегда видна -->
					<a
						href={category === "guides"
							? "/blog/guides"
							: "/blog/cases"}
						class="flex-1 bg-blue-600 text-white px-8 py-4 rounded-xl font-semibold hover:bg-blue-700 transition-all duration-300 inline-flex items-center justify-center gap-3 shadow-lg hover:shadow-xl"
					>
						{
							category === "guides" && (
								<svg
									class="w-5 h-5 relative -top-px"
									fill="none"
									stroke="currentColor"
									viewBox="0 0 24 24"
								>
									<path
										stroke-linecap="round"
										stroke-linejoin="round"
										stroke-width="2"
										d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
									/>
								</svg>
							)
						}
						{
							category === "cases" && (
								<svg
									class="w-5 h-5"
									fill="none"
									stroke="currentColor"
									viewBox="0 0 24 24"
								>
									<path
										stroke-linecap="round"
										stroke-linejoin="round"
										stroke-width="2"
										d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
									/>
								</svg>
							)
						}
						{
							category === "guides"
								? "Смотреть все гайды"
								: "Смотреть все кейсы"
						}
					</a>

					<!-- Вторичная кнопка -->
					<a
						href="https://sellyzer.ru"
						target="_blank"
						rel="noopener noreferrer"
						class="flex-1 border-2 border-blue-600 text-blue-600 px-8 py-4 rounded-xl font-semibold hover:bg-blue-600 hover:text-white transition-all duration-300 inline-flex items-center justify-center gap-3"
					>
						<svg
							class="w-5 h-5"
							fill="none"
							stroke="currentColor"
							viewBox="0 0 24 24"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								stroke-width="2"
								d="M13 10V3L4 14h7v7l9-11h-7z"></path>
						</svg>
						Попробовать Sellyzer
					</a>
				</div>
			</div>
		</div>
	</section>
</BasePageLayout>
